<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quiz Trainer</title>

  <!-- PWA / iOS meta -->
  <meta name="theme-color" content="#0a84ff" />
  <link rel="manifest" href="manifest.json" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="apple-touch-icon" href="icon-192.png" />

  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <!-- Sticky Topbar -->
  <header class="topbar">
    <div class="topbar-left">
      <button class="icon-btn" id="toggleAuthBtn" aria-label="Profil √∂ffnen">‚ò∞</button>
      <div class="brand">
        <h1>Quiz Trainer</h1>
        <p class="subtitle">√úbungsmodus ‚Ä¢ Pr√ºfungsmodus (IHK) ‚Ä¢ Statistik ‚Äî offline & iPhone-ready</p>
      </div>
    </div>

    <div class="topbar-right">
      <div class="status-pill" id="authStatus">Firebase: l√§dt‚Ä¶</div>
      <div class="timer" id="examTimer" hidden>‚è± 00:00</div>
    </div>
  </header>

  <!-- Slide-in Auth Panel -->
  <aside class="auth-panel" id="authPanel" aria-label="Profil & Login" hidden>
    <div class="auth-panel-inner">
      <div class="auth-head">
        <h2>Profil</h2>
        <button class="icon-btn" id="closeAuthBtn" aria-label="Schlie√üen">‚úï</button>
      </div>

      <div class="auth-box">
        <p class="muted" id="authHint">
          Mit Login werden deine Ergebnisse in der Cloud gespeichert (Firestore).
          Ohne Login bleibt alles lokal auf diesem Ger√§t.
        </p>

        <label class="field">
          <span>Email</span>
          <input id="email" type="email" placeholder="Email" autocomplete="email" />
        </label>

        <label class="field">
          <span>Passwort</span>
          <input id="password" type="password" placeholder="Passwort" autocomplete="current-password" />
        </label>

        <div class="auth-actions">
          <button class="primary" onclick="login()">Einloggen</button>
          <button onclick="register()">Registrieren</button>
          <button class="danger" onclick="logout()">Logout</button>
        </div>

        <hr class="sep" />

        <div class="small-actions">
          <button onclick="syncLocalToCloud()">‚¨Ü Lokale Daten in Cloud kopieren</button>
          <button onclick="wipeLocalStats()">üßπ Lokale Statistik l√∂schen</button>
        </div>
      </div>
    </div>
  </aside>

  <main class="container">
    <nav id="menu" class="menu" aria-label="Hauptmen√º">
      <button class="cardbtn" onclick="startPractice()" aria-label="√úbungsmodus starten">
        üü¢ √úbungsmodus <span class="hint">Sofort Feedback + Erkl√§rung</span>
      </button>

      <button class="cardbtn" onclick="startExam()" aria-label="Pr√ºfungsmodus starten">
        üîµ Pr√ºfungsmodus (IHK) <span class="hint">30 Fragen ‚Ä¢ Timer ‚Ä¢ Ergebnis pro Kategorie</span>
      </button>

      <button class="cardbtn" onclick="showStats()" aria-label="Statistik anzeigen">
        üìä Statistik <span class="hint">Best / √ò / Verlauf</span>
      </button>
    </nav>

    <section id="quiz" class="quiz" aria-live="polite"></section>
    <section id="result" class="result" aria-live="polite"></section>

    <footer class="footer">
      <small>Offline-ready PWA ‚Äî iPhone: Share ‚Üí Add to Home Screen</small>
    </footer>
  </main>

  <!-- Firebase (COMPAT!) -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script src="firebase.js"></script>

  <!-- Daten + Logik -->
  <script src="database.js"></script>
  <script src="quiz.js"></script>

  <!-- Service worker reg -->
  <script>
    if ("serviceWorker" in navigator) {
      window.addEventListener("load", () => {
        navigator.serviceWorker.register("sw.js")
          .then(reg => console.log("SW registered:", reg.scope))
          .catch(err => console.warn("SW reg failed:", err));
      });
    }
  </script>
</body>
</html>
