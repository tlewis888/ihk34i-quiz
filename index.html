<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>IHK34i Quiz Trainer</title>

  <!-- PWA -->
  <meta name="theme-color" content="#0a84ff" />
  <link rel="manifest" href="manifest.json" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />
  <link rel="apple-touch-icon" href="icon-192.png" />

  <link rel="stylesheet" href="style.css" />
</head>

<body>
  <!-- Sticky Topbar -->
  <header class="topbar">
    <div class="topbar__left">
      <div class="brand">
        <div class="brand__title">IHK34i Quiz</div>
        <div class="brand__sub">Offline â€¢ iPhone-ready â€¢ Cloud-Profil</div>
      </div>
    </div>

    <div class="topbar__right">
      <div id="userBadge" class="userBadge hidden"></div>
      <button id="btnOpenAuth" class="btn btn--ghost">Anmelden</button>
      <button id="btnLogout" class="btn btn--ghost hidden">Abmelden</button>
    </div>
  </header>

  <main class="container">
    <section class="panel">
      <nav id="menu" class="menu" aria-label="HauptmenÃ¼">
        <button class="btn" onclick="startPractice()">ğŸŸ¢ Ãœbungsmodus</button>
        <button class="btn" onclick="startExamB()">ğŸ”µ PrÃ¼fungsmodus B (IHK)</button>
        <button class="btn btn--ghost" onclick="showStats()">ğŸ“Š Statistik</button>
        <button class="btn btn--ghost" onclick="resetLocal()">ğŸ§¹ Reset (nur GerÃ¤t)</button>
      </nav>

      <div class="metaRow">
        <div id="syncState" class="pill">Offline bereit</div>
        <div id="examState" class="pill pill--muted">Kein Test aktiv</div>
      </div>
    </section>

    <section id="result" class="result" aria-live="polite"></section>
    <section id="quiz" class="quiz" aria-live="polite"></section>
  </main>

  <footer class="footer">
    <small>Tip: iPhone Safari â†’ Share â†’ â€œAdd to Home Screenâ€</small>
  </footer>

  <!-- Auth Modal -->
  <div id="authModal" class="modal hidden" role="dialog" aria-modal="true" aria-label="Login">
    <div class="modal__card">
      <div class="modal__header">
        <h2>Profil</h2>
        <button id="btnCloseAuth" class="btn btn--ghost">âœ•</button>
      </div>

      <div class="tabs">
        <button class="tab active" data-tab="login">Login</button>
        <button class="tab" data-tab="register">Register</button>
      </div>

      <div class="modal__body">
        <div class="formRow">
          <label>E-Mail</label>
          <input id="authEmail" type="email" placeholder="name@mail.com" autocomplete="email" />
        </div>
        <div class="formRow">
          <label>Passwort</label>
          <input id="authPass" type="password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password" />
        </div>

        <div class="row">
          <button id="btnDoLogin" class="btn">Anmelden</button>
          <button id="btnDoRegister" class="btn hidden">Konto erstellen</button>
        </div>

        <p class="hint" id="authHint">
          Tipp: Login = bestehÅ‘ fiÃ³k. Register = Ãºj fiÃ³k.
        </p>

        <div class="divider"></div>

        <p class="hint">
          MentÃ©s:
          <b>Ha be vagy jelentkezve</b> â†’ Firestore (felhÅ‘, tÃ¶bb eszkÃ¶z).
          <b>Ha nem</b> â†’ csak a telefon/gÃ©p (offline localStorage).
        </p>

        <div id="authMsg" class="notice hidden"></div>
      </div>
    </div>
  </div>

  <!-- Daten -->
  <script src="database.js"></script>

  <!-- App modules -->
  <script type="module" src="firebase.js"></script>
  <script type="module" src="quiz.js"></script>

  <!-- Service worker -->
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('sw.js').catch(() => {});
      });
    }
  </script>
</body>
</html>
